#!/bin/bash

#system information gathered
system_hostname=$(hostname)
system_os=$(lsb_release -d | awk -F"\t" '{print $2}')
system_uptime=$(uptime -p)

# Gather hardware information
cpu_model=$(cat /proc/cpuinfo | grep "model name" | uniq | awk -F": " '{print $2}')
cpu_speed=$(lscpu | grep "MHz" | awk '{print $3}')
ram_size=$(free -h | awk '/Mem/ {print $2}')
disk_space=$(df -h | awk '$NF=="/" {printf "Disk: %d/%dGB (%s)\n", $3, $2, $5}')
video_card=$(lspci | grep -i "VGA" | awk -F": " '{print $2}')

# gathered network information
fqdn=$(hostname -f)
host_address=$(hostname -I | awk '{print $1}')
gateway_ip=$(ip route | awk '/default/ {print $3}')
dns_server=$(cat /etc/resolv.conf | grep "nameserver" | awk '{print $2}')
interfaces=$(ip -o link show | awk -F': ' '{print $2}')
network_card=$(lspci | grep -i "network" | awk -F": " '{print $2}')
ip_cidr=$(ip -o -4 addr show $network_interface | awk '/inet / {print $4}')

# gathered system status
users_logged_in=$(who | awk '{print $1}' | sort | uniq | tr '\n' ',' | sed 's/,$//')
disk_usage=$(df -h | awk '/^\/dev/ {print $6" "$4}')
process_count=$(ps aux | wc -l)
load_averages=$(uptime | awk -F'average: ' '{print $2}')
memory_info=$(free -m)
listening_ports=$(ss -tuln | awk '{print $5}' | cut -d ':' -f2 | grep -E "^[0-9]" | sort -n | uniq | tr '\n' ', ' | sed 's/,$//')
ufw_rules=$(sudo ufw status numbered | awk '{print $1" "$2" "$3}')

# system report
echo ""
echo "System Report generated by $(whoami), $(date)"
echo ""
echo "System Information"
echo "------------------"
echo "Hostname: $system_hostname"
echo "OS: $system_os"
echo "Uptime: $system_uptime"
echo ""
echo "Hardware Information"
echo "--------------------"
echo "CPU: $cpu_model"
echo "Speed: $cpu_speed MHz"
echo "RAM: $ram_size"
echo "$disk_space"
echo "Video: $video_card"
echo ""
echo "Network Information"
echo "-------------------"
echo "FQDN: $fqdn"
echo "Host Address: $host_address"
echo "Gateway IP: $gateway_ip"
echo "DNS Server: $dns_server"
echo ""
echo "Interfaces Names:"
echo "$interfaces"
echo ""
echo "Network Card: $network_card"
echo "IP Address: $ip_cidr"
echo ""
echo "System Status:"
echo "-------------"
echo "Users Logged In: ${users_logged_in%,}"
echo "Disk Space: $disk_usage"
echo "Process Count: $process_count"
echo "Load Averages: $load_averages"
echo "Memory Allocation:"
echo "$memory_info"
echo ""
echo "Listening Network Ports: $listening_ports"
echo "UFW Rules: $ufw_rules"
echo ""

# End of Report
